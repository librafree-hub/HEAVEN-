<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>HEAVEN - 自動投稿システム</title>
  <link rel="stylesheet" href="/css/style.css">
</head>
<body>
  <div class="app">
    <!-- サイドバー -->
    <nav class="sidebar">
      <div class="sidebar-header">
        <h1>HEAVEN</h1>
        <p>自動投稿システム</p>
      </div>
      <ul class="nav-menu">
        <li><a href="#" data-page="dashboard" class="active">ダッシュボード</a></li>
        <li><a href="#" data-page="diary" class="nav-feature">写メ日記 自動投稿</a></li>
        <li><a href="#" data-page="settings">設定</a></li>
      </ul>
    </nav>

    <!-- メインコンテンツ -->
    <main class="content">

      <!-- ダッシュボード -->
      <div id="page-dashboard" class="page active">
        <h2>ダッシュボード</h2>

        <div class="stats-grid">
          <div class="stat-card">
            <div class="stat-number" id="stat-today">0</div>
            <div class="stat-label">今日の投稿</div>
          </div>
          <div class="stat-card success">
            <div class="stat-number" id="stat-success">0</div>
            <div class="stat-label">成功</div>
          </div>
          <div class="stat-card danger">
            <div class="stat-number" id="stat-failed">0</div>
            <div class="stat-label">失敗</div>
          </div>
          <div class="stat-card">
            <div class="stat-number" id="stat-total">0</div>
            <div class="stat-label">総投稿数</div>
          </div>
        </div>

        <div class="action-bar">
          <button class="btn btn-primary" onclick="App.postAll()">全アカウント投稿</button>
          <button class="btn btn-secondary" id="btn-scheduler" onclick="App.toggleScheduler()">スケジューラー開始</button>
          <span id="scheduler-status" class="status-badge">停止中</span>
        </div>

        <div class="card">
          <h3>最近の投稿</h3>
          <div id="recent-posts">読み込み中...</div>
        </div>
      </div>

      <!-- 写メ日記 自動投稿 -->
      <div id="page-diary" class="page">
        <h2>写メ日記 自動投稿</h2>

        <!-- サブタブ -->
        <div class="sub-tabs">
          <button class="sub-tab active" data-subtab="diary-accounts" onclick="App.switchSubTab('diary', 'diary-accounts')">アカウント管理</button>
          <button class="sub-tab" data-subtab="diary-schedule" onclick="App.switchSubTab('diary', 'diary-schedule')">一括スケジュール</button>
          <button class="sub-tab" data-subtab="diary-posts" onclick="App.switchSubTab('diary', 'diary-posts')">投稿履歴</button>
        </div>

        <!-- サブタブ: アカウント管理 -->
        <div id="subtab-diary-accounts" class="subtab-content active">
          <div class="action-bar">
            <button class="btn btn-primary" onclick="App.showAddAccount()">+ アカウント追加</button>
          </div>

          <div id="accounts-list" class="accounts-grid">読み込み中...</div>
        </div>

        <!-- サブタブ: 一括スケジュール -->
        <div id="subtab-diary-schedule" class="subtab-content">
          <div class="bulk-add-section">
            <p>時刻を選んで、追加したいアカウントにチェックを入れて「追加」</p>
            <div style="display:flex;gap:8px;align-items:center;margin-top:10px;flex-wrap:wrap;">
              <select id="bulk-addHour" style="width:auto;">
                <option value="0">0</option><option value="1">1</option><option value="2">2</option>
                <option value="3">3</option><option value="4">4</option><option value="5">5</option>
                <option value="6">6</option><option value="7">7</option><option value="8">8</option>
                <option value="9">9</option><option value="10">10</option><option value="11">11</option>
                <option value="12">12</option><option value="13">13</option><option value="14">14</option>
                <option value="15">15</option><option value="16">16</option><option value="17">17</option>
                <option value="18">18</option><option value="19">19</option><option value="20">20</option>
                <option value="21">21</option><option value="22">22</option><option value="23">23</option>
              </select>
              <span>時</span>
              <select id="bulk-addMin" style="width:auto;">
                <option value="00">00</option><option value="10">10</option><option value="20">20</option>
                <option value="30">30</option><option value="40">40</option><option value="50">50</option>
              </select>
              <span>分</span>
              <button type="button" class="btn btn-sm btn-primary" onclick="App.bulkAddTime()">選択中に追加</button>
              <button type="button" class="btn btn-sm btn-danger" onclick="App.bulkRemoveTime()">選択中から削除</button>
              <label class="toggle-label" style="margin-left:8px;">
                <input type="checkbox" id="bulk-check-all" onchange="App.bulkToggleAll(this.checked)">
                <span>全選択</span>
              </label>
            </div>
          </div>

          <div id="bulk-schedule-list" class="bulk-schedule-list" style="margin-top:16px;"></div>

          <div class="form-actions">
            <button type="button" class="btn btn-primary" onclick="App.bulkSave()">一括保存</button>
          </div>
        </div>

        <!-- サブタブ: 投稿履歴 -->
        <div id="subtab-diary-posts" class="subtab-content">
          <div id="posts-list">読み込み中...</div>
        </div>

        <!-- アカウント編集モーダル -->
        <div id="modal-account" class="modal" style="display:none;">
          <div class="modal-content">
            <div class="modal-header">
              <h3 id="modal-account-title">アカウント編集</h3>
              <button class="btn-close" onclick="App.closeModal('modal-account')">&times;</button>
            </div>
            <form id="form-account" onsubmit="App.saveAccount(event)">
              <input type="hidden" id="acc-id">

              <div class="form-grid">
                <div class="form-group">
                  <label>名前</label>
                  <input type="text" id="acc-name" required placeholder="りな">
                </div>
                <div class="form-group">
                  <label>1日の投稿数</label>
                  <input type="number" id="acc-postsPerDay" value="3" min="1" max="10">
                </div>
              </div>

              <div class="form-group">
                <label>性格</label>
                <input type="text" id="acc-personality" placeholder="明るくお茶目、アクティブなライフスタイル">
              </div>
              <div class="form-group">
                <label>口調</label>
                <input type="text" id="acc-tone" placeholder="フレンドリーで絵文字多め♪">
              </div>
              <div class="form-group">
                <label>趣味・興味（カンマ区切り）</label>
                <input type="text" id="acc-interests" placeholder="カフェ, ショッピング, 美容">
              </div>
              <div class="form-group">
                <label>文体</label>
                <input type="text" id="acc-writingStyle" placeholder="短文でテンポよく、明るい印象">
              </div>

              <hr>
              <h4>シティヘブン ログイン情報</h4>

              <div class="form-group">
                <label>ログインURL</label>
                <input type="text" id="acc-loginUrl" placeholder="https://d-heaven.net/">
              </div>
              <div class="form-grid">
                <div class="form-group">
                  <label>ログインID</label>
                  <input type="text" id="acc-loginId">
                </div>
                <div class="form-group">
                  <label>パスワード</label>
                  <input type="password" id="acc-loginPassword">
                </div>
              </div>
              <div class="form-group">
                <label>日記投稿URL</label>
                <input type="text" id="acc-diaryUrl" placeholder="https://spgirl.cityheaven.net/J4KeitaiDiaryPost.php?gid=...">
              </div>

              <hr>
              <h4>投稿スケジュール</h4>
              <small>この子の投稿時刻を設定（10分単位で指定可能）</small>

              <div class="schedule-time-picker" style="margin-top:12px;">
                <div class="form-grid">
                  <div class="form-group">
                    <label>時刻を追加</label>
                    <div style="display:flex;gap:8px;align-items:center;">
                      <select id="acc-addHour" style="width:auto;">
                        <option value="0">0</option><option value="1">1</option><option value="2">2</option>
                        <option value="3">3</option><option value="4">4</option><option value="5">5</option>
                        <option value="6">6</option><option value="7">7</option><option value="8">8</option>
                        <option value="9">9</option><option value="10">10</option><option value="11">11</option>
                        <option value="12">12</option><option value="13">13</option><option value="14">14</option>
                        <option value="15">15</option><option value="16">16</option><option value="17">17</option>
                        <option value="18">18</option><option value="19">19</option><option value="20">20</option>
                        <option value="21">21</option><option value="22">22</option><option value="23">23</option>
                      </select>
                      <span>時</span>
                      <select id="acc-addMin" style="width:auto;">
                        <option value="00">00</option><option value="10">10</option><option value="20">20</option>
                        <option value="30">30</option><option value="40">40</option><option value="50">50</option>
                      </select>
                      <span>分</span>
                      <button type="button" class="btn btn-sm btn-primary" onclick="App.addScheduleTime()">追加</button>
                    </div>
                  </div>
                </div>
                <div id="acc-scheduleTimes" class="schedule-times-list"></div>
              </div>

              <hr>
              <h4>投稿オプション</h4>

              <div class="form-grid">
                <div class="form-group">
                  <label>投稿方法</label>
                  <select id="acc-postType">
                    <option value="diary">写メ日記</option>
                    <option value="freepost">フリーポスト（24時間で消える）</option>
                    <option value="random">ランダム（毎回どちらかを自動選択）</option>
                  </select>
                </div>
                <div class="form-group">
                  <label>公開範囲</label>
                  <select id="acc-visibility">
                    <option value="public">全公開</option>
                    <option value="mygirl">マイガール限定</option>
                    <option value="random">ランダム（毎回どちらかを自動選択）</option>
                  </select>
                </div>
              </div>

              <div class="form-actions">
                <button type="submit" class="btn btn-primary">保存</button>
                <button type="button" class="btn btn-secondary" onclick="App.closeModal('modal-account')">キャンセル</button>
              </div>
            </form>
          </div>
        </div>

        <!-- 画像管理モーダル -->
        <div id="modal-images" class="modal" style="display:none;">
          <div class="modal-content">
            <div class="modal-header">
              <h3 id="modal-images-title">画像管理</h3>
              <button class="btn-close" onclick="App.closeModal('modal-images')">&times;</button>
            </div>
            <div class="image-upload-area">
              <input type="file" id="image-upload" multiple accept="image/*" onchange="App.uploadImages(event)">
              <label for="image-upload" class="upload-label">画像をドラッグ＆ドロップ または クリックして選択</label>
            </div>
            <div id="image-list" class="image-grid"></div>
          </div>
        </div>
      </div>

      <!-- 設定 -->
      <div id="page-settings" class="page">
        <h2>設定</h2>

        <form id="form-settings" onsubmit="App.saveSettings(event)">
          <div class="card">
            <h3>日記生成</h3>
            <div class="form-grid">
              <div class="form-group">
                <label>最小文字数</label>
                <input type="number" id="set-minChars" value="450">
              </div>
              <div class="form-group">
                <label>最大文字数</label>
                <input type="number" id="set-maxChars" value="1000">
              </div>
            </div>
          </div>

          <div class="card">
            <h3>投稿制御</h3>
            <div class="form-group">
              <label class="toggle-label">
                <input type="checkbox" id="set-postingEnabled">
                <span>実際にシティヘブンに投稿する</span>
              </label>
              <small>OFFの場合、日記生成のみ行い投稿はスキップします（テストモード）</small>
            </div>
          </div>

          <div class="card">
            <h3>デフォルト投稿オプション</h3>
            <small>アカウント個別に設定がない場合、この値が使われます</small>
            <div class="form-grid" style="margin-top:12px;">
              <div class="form-group">
                <label>投稿方法</label>
                <select id="set-postType">
                  <option value="diary">写メ日記</option>
                  <option value="freepost">フリーポスト</option>
                  <option value="random">ランダム</option>
                </select>
              </div>
              <div class="form-group">
                <label>公開範囲</label>
                <select id="set-visibility">
                  <option value="public">全公開</option>
                  <option value="mygirl">マイガール限定</option>
                  <option value="random">ランダム</option>
                </select>
              </div>
            </div>
          </div>

          <button type="submit" class="btn btn-primary">設定を保存</button>
        </form>
      </div>
    </main>
  </div>

  <script src="/js/app.js"></script>
</body>
</html>
