<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>HEAVEN - 自動日記投稿システム</title>
  <link rel="stylesheet" href="/css/style.css">
</head>
<body>
  <div class="app">
    <!-- サイドバー -->
    <nav class="sidebar">
      <div class="sidebar-header">
        <h1>HEAVEN</h1>
        <p>自動日記投稿</p>
      </div>
      <ul class="nav-menu">
        <li><a href="#" data-page="dashboard" class="active">ダッシュボード</a></li>
        <li><a href="#" data-page="accounts">アカウント管理</a></li>
        <li><a href="#" data-page="mitene">ミテネ</a></li>
        <li><a href="#" data-page="posts">投稿履歴</a></li>
        <li><a href="#" data-page="settings">設定</a></li>
      </ul>
    </nav>

    <!-- メインコンテンツ -->
    <main class="content">

      <!-- ダッシュボード -->
      <div id="page-dashboard" class="page active">
        <h2>ダッシュボード</h2>

        <div class="stats-grid">
          <div class="stat-card">
            <div class="stat-number" id="stat-today">0</div>
            <div class="stat-label">今日の投稿</div>
          </div>
          <div class="stat-card success">
            <div class="stat-number" id="stat-success">0</div>
            <div class="stat-label">成功</div>
          </div>
          <div class="stat-card danger">
            <div class="stat-number" id="stat-failed">0</div>
            <div class="stat-label">失敗</div>
          </div>
          <div class="stat-card">
            <div class="stat-number" id="stat-total">0</div>
            <div class="stat-label">総投稿数</div>
          </div>
        </div>

        <div class="action-bar">
          <button class="btn btn-primary" onclick="App.postAll()">全アカウント投稿</button>
          <button class="btn btn-secondary" id="btn-scheduler" onclick="App.toggleScheduler()">スケジューラー開始</button>
          <span id="scheduler-status" class="status-badge">停止中</span>
          <span style="margin-left: 8px;"></span>
          <button class="btn btn-mitene" onclick="App.miteneAll()">ミテネ一括送信</button>
          <button class="btn btn-secondary" id="btn-mitene-scheduler" onclick="App.toggleMiteneScheduler()">ミテネスケジューラー開始</button>
          <span id="mitene-scheduler-status" class="status-badge">停止中</span>
        </div>

        <div class="card">
          <h3>最近の投稿</h3>
          <div id="recent-posts">読み込み中...</div>
        </div>
      </div>

      <!-- アカウント管理 -->
      <div id="page-accounts" class="page">
        <h2>アカウント管理</h2>

        <button class="btn btn-primary" onclick="App.showAddAccount()">+ アカウント追加</button>

        <div id="accounts-list" class="accounts-grid">読み込み中...</div>

        <!-- アカウント編集モーダル -->
        <div id="modal-account" class="modal" style="display:none;">
          <div class="modal-content">
            <div class="modal-header">
              <h3 id="modal-account-title">アカウント編集</h3>
              <button class="btn-close" onclick="App.closeModal('modal-account')">&times;</button>
            </div>
            <form id="form-account" onsubmit="App.saveAccount(event)">
              <input type="hidden" id="acc-id">

              <div class="form-grid">
                <div class="form-group">
                  <label>名前</label>
                  <input type="text" id="acc-name" required placeholder="りな">
                </div>
                <div class="form-group">
                  <label>1日の投稿数</label>
                  <input type="number" id="acc-postsPerDay" value="3" min="1" max="10">
                </div>
              </div>

              <div class="form-group">
                <label>性格</label>
                <input type="text" id="acc-personality" placeholder="明るくお茶目、アクティブなライフスタイル">
              </div>
              <div class="form-group">
                <label>口調</label>
                <input type="text" id="acc-tone" placeholder="フレンドリーで絵文字多め♪">
              </div>
              <div class="form-group">
                <label>趣味・興味（カンマ区切り）</label>
                <input type="text" id="acc-interests" placeholder="カフェ, ショッピング, 美容">
              </div>
              <div class="form-group">
                <label>文体</label>
                <input type="text" id="acc-writingStyle" placeholder="短文でテンポよく、明るい印象">
              </div>

              <hr>
              <h4>シティヘブン ログイン情報</h4>

              <div class="form-group">
                <label>ログインURL</label>
                <input type="text" id="acc-loginUrl" placeholder="https://d-heaven.net/">
              </div>
              <div class="form-grid">
                <div class="form-group">
                  <label>ログインID</label>
                  <input type="text" id="acc-loginId">
                </div>
                <div class="form-group">
                  <label>パスワード</label>
                  <input type="password" id="acc-loginPassword">
                </div>
              </div>
              <div class="form-group">
                <label>日記投稿URL</label>
                <input type="text" id="acc-diaryUrl" placeholder="https://spgirl.cityheaven.net/J4KeitaiDiaryPost.php?gid=...">
              </div>
              <div class="form-group">
                <label>ミテネURL（空欄の場合は自動検出）</label>
                <input type="text" id="acc-miteneUrl" placeholder="https://spgirl.cityheaven.net/J4Kitene.php?gid=...">
              </div>

              <hr>
              <h4>投稿オプション</h4>

              <div class="form-grid">
                <div class="form-group">
                  <label>投稿方法</label>
                  <select id="acc-postType">
                    <option value="diary">写メ日記</option>
                    <option value="freepost">フリーポスト（24時間で消える）</option>
                    <option value="random">ランダム（毎回どちらかを自動選択）</option>
                  </select>
                </div>
                <div class="form-group">
                  <label>公開範囲</label>
                  <select id="acc-visibility">
                    <option value="public">全公開</option>
                    <option value="mygirl">マイガール限定</option>
                    <option value="random">ランダム（毎回どちらかを自動選択）</option>
                  </select>
                </div>
              </div>

              <div class="form-actions">
                <button type="submit" class="btn btn-primary">保存</button>
                <button type="button" class="btn btn-secondary" onclick="App.closeModal('modal-account')">キャンセル</button>
              </div>
            </form>
          </div>
        </div>

        <!-- 画像管理モーダル -->
        <div id="modal-images" class="modal" style="display:none;">
          <div class="modal-content">
            <div class="modal-header">
              <h3 id="modal-images-title">画像管理</h3>
              <button class="btn-close" onclick="App.closeModal('modal-images')">&times;</button>
            </div>
            <div class="image-upload-area">
              <input type="file" id="image-upload" multiple accept="image/*" onchange="App.uploadImages(event)">
              <label for="image-upload" class="upload-label">画像をドラッグ＆ドロップ または クリックして選択</label>
            </div>
            <div id="image-list" class="image-grid"></div>
          </div>
        </div>
      </div>

      <!-- ミテネ -->
      <div id="page-mitene" class="page">
        <h2>ミテネ（旧キテネ）自動送信</h2>

        <div class="action-bar">
          <button class="btn btn-mitene" onclick="App.miteneAll()">全アカウント ミテネ送信</button>
          <button class="btn btn-secondary" id="btn-mitene-scheduler-page" onclick="App.toggleMiteneScheduler()">ミテネスケジューラー開始</button>
          <span id="mitene-scheduler-status-page" class="status-badge">停止中</span>
        </div>

        <div class="card">
          <h3>アカウント別 ミテネ送信</h3>
          <div id="mitene-accounts-list">読み込み中...</div>
        </div>

        <div class="card">
          <h3>ミテネ送信履歴</h3>
          <div id="mitene-history">読み込み中...</div>
        </div>
      </div>

      <!-- 投稿履歴 -->
      <div id="page-posts" class="page">
        <h2>投稿履歴</h2>
        <div id="posts-list">読み込み中...</div>
      </div>

      <!-- 設定 -->
      <div id="page-settings" class="page">
        <h2>設定</h2>

        <form id="form-settings" onsubmit="App.saveSettings(event)">
          <div class="card">
            <h3>日記生成</h3>
            <div class="form-grid">
              <div class="form-group">
                <label>最小文字数</label>
                <input type="number" id="set-minChars" value="450">
              </div>
              <div class="form-group">
                <label>最大文字数</label>
                <input type="number" id="set-maxChars" value="1000">
              </div>
            </div>
          </div>

          <div class="card">
            <h3>スケジュール</h3>
            <div class="form-group">
              <label>Cron式</label>
              <input type="text" id="set-schedule" value="0 */3 8-23 * * *">
              <small>デフォルト: 8時〜23時の間、3時間ごと</small>
            </div>
          </div>

          <div class="card">
            <h3>投稿制御</h3>
            <div class="form-group">
              <label class="toggle-label">
                <input type="checkbox" id="set-postingEnabled">
                <span>実際にシティヘブンに投稿する</span>
              </label>
              <small>OFFの場合、日記生成のみ行い投稿はスキップします（テストモード）</small>
            </div>
          </div>

          <div class="card">
            <h3>ミテネ設定</h3>
            <div class="form-group">
              <label class="toggle-label">
                <input type="checkbox" id="set-miteneEnabled">
                <span>ミテネ自動送信を有効にする</span>
              </label>
              <small>ONにすると、スケジュールに従ってミテネを自動送信します</small>
            </div>
            <div class="form-group">
              <label>ミテネ Cron式</label>
              <input type="text" id="set-miteneSchedule" value="0 */2 8-23 * * *">
              <small>デフォルト: 8時〜23時の間、2時間ごと</small>
            </div>
          </div>

          <div class="card">
            <h3>デフォルト投稿オプション</h3>
            <small>アカウント個別に設定がない場合、この値が使われます</small>
            <div class="form-grid" style="margin-top:12px;">
              <div class="form-group">
                <label>投稿方法</label>
                <select id="set-postType">
                  <option value="diary">写メ日記</option>
                  <option value="freepost">フリーポスト</option>
                  <option value="random">ランダム</option>
                </select>
              </div>
              <div class="form-group">
                <label>公開範囲</label>
                <select id="set-visibility">
                  <option value="public">全公開</option>
                  <option value="mygirl">マイガール限定</option>
                  <option value="random">ランダム</option>
                </select>
              </div>
            </div>
          </div>

          <button type="submit" class="btn btn-primary">設定を保存</button>
        </form>
      </div>
    </main>
  </div>

  <script src="/js/app.js"></script>
</body>
</html>
